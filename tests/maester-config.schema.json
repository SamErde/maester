{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://maester.dev/schemas/maester-config.json",
  "title": "Maester Configuration Schema",
  "description": "Schema for Maester configuration files",
  "type": "object",
  "properties": {
    "version": {
      "type": "string",
      "description": "Semantic version of the Maester test configuration schema.",
      "pattern": "^\\d+\\.\\d+\\.\\d+(?:-[a-zA-Z0-9]+(?:\\.[a-zA-Z0-9]+)*)?(?:\\+[a-zA-Z0-9]+(?:\\.[a-zA-Z0-9]+)*)?$"
    },

    "AccountSettings": {
      "type": "array",
      "description": "Settings for accounts evaluated during the tests. Managed service identities could also be added here.",
      "items": {
        "type": "object",
        "properties": {
          "EmergencyAccess": {
            "type": "array",
            "description": "Emergency access account user principal names.",
            "items": {
              "type": "string"
            }
          },
          "PrivilegedAdmin": {
            "type": "array",
            "description": "Privileged admin account user principal names.",
            "items": {
              "type": "string"
            }
          }
        }
      }
    },

    "TestSettings": {
      "type": "array",
      "description": "Configuration Settings for Maester Tests",
      "items": {
        "type": "object",
        "required": [
          "Id",
          "Title",
          "Severity"
        ],
        "additionalProperties": false,
        "properties": {
          "Id": {
            "type": "string",
            "description": "Unique identifier for the test",
            "pattern": "^(CIS\\.M365|CISA\\.MS\\.(AAD|EXO|EID|SHAREPOINT)|MT|ORCA)\\.[0-9]+(\\.[0-9]+)*$|^EIDSCA\\.[A-Z]{2}[0-9]{2}$"
          },
          "Severity": {
            "type": "string",
            "description": "Severity level of the test",
            "enum": ["High", "Medium", "Low", "Info"]
          },
          "Title": {
            "type": "string",
            "description": "Human-readable title of the test"
          },
          "License": {
            "type": "array",
            "description": "License required for the feature being tested.",
            "items": {
              "type": "string",
              "enum": ["A3", "A5", "E3", "E5", "P1", "P2", "F1", "F3", "F5", "Business Premium", "BP", "MDOP1", "MDOP2", "MDEP1", "MDEP2"]
            }
          }
        }
      }
    }
  }
}
